<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Orb Game</title>
  <style>
    /* The canvas size is controlled here â€“ do not change these dimensions */
    canvas {
      display: block;
      margin: 0 auto;
      background: #000;
    }
  </style>
</head>
<body>
  <!-- The canvas element has a fixed size (do not change) -->
  <canvas id="gameCanvas" width="800" height="600"></canvas>
  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    // Game variables
    let lives = 5; // Increased lives to 5
    let orbs = [];

    // Orb class definition:
    class Orb {
      constructor(x, y, radius, speed) {
        this.x = x;
        this.y = y;
        this.radius = radius;
        this.speed = speed;
      }
      update() {
        // Move upward from the very bottom of the screen toward the top
        this.y -= this.speed;
        // Check if the orb has collided with the top (end wall)
        if (this.y - this.radius <= 0) {
          shakeScreen();
          // In a real game you might remove the orb or reset it.
          // Here, we simply remove it by marking its y outside the visible area.
          this.y = -this.radius;
          // Optionally, you could subtract a life or trigger another event here.
        }
      }
      draw() {
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
        ctx.fillStyle = '#fff';
        ctx.fill();
        ctx.closePath();
      }
    }

    // Create a new orb at the bottom of the screen
    function createOrb() {
      const x = Math.random() * canvas.width;
      const y = canvas.height;  // spawn at the very bottom
      const radius = 10;
      const speed = Math.random() * 2 + 2; // random speed between 2 and 4
      const orb = new Orb(x, y, radius, speed);
      orbs.push(orb);
    }

    // Screen shake effect variables
    let shakeDuration = 0;
    const shakeMagnitude = 10;

    function shakeScreen() {
      shakeDuration = 20; // Shake for 20 frames
    }

    function update() {
      // Update orbs
      for (let i = 0; i < orbs.length; i++) {
        orbs[i].update();
      }
      // Remove orbs that are off-screen (above the top)
      orbs = orbs.filter(orb => orb.y + orb.radius > 0);
      // Update shake duration counter
      if (shakeDuration > 0) {
        shakeDuration--;
      }
    }

    function draw() {
      // Apply screen shake transform if active
      if (shakeDuration > 0) {
        const dx = (Math.random() - 0.5) * shakeMagnitude;
        const dy = (Math.random() - 0.5) * shakeMagnitude;
        ctx.setTransform(1, 0, 0, 1, dx, dy);
      } else {
        ctx.setTransform(1, 0, 0, 1, 0, 0);
      }
      // Clear the canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      // Draw all orbs
      for (let orb of orbs) {
        orb.draw();
      }
      // Reset transform for UI drawing
      ctx.setTransform(1, 0, 0, 1, 0, 0);
      // Display the lives count
      ctx.font = '20px Arial';
      ctx.fillStyle = '#fff';
      ctx.fillText("Lives: " + lives, 10, 30);
    }

    function gameLoop() {
      update();
      draw();
      requestAnimationFrame(gameLoop);
    }

    // Start the game loop
    gameLoop();

    // Create orbs periodically (one orb per second)
    setInterval(createOrb, 1000);
  </script>
</body>
</html>
